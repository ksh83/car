<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë””ì§€í„¸ ì†Œë°©ì°¨ëŸ‰ ì•„ì¹´ì´ë¸Œ (ì—…ë°ì´íŠ¸ í”„ë¡œí† íƒ€ì…)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Noto Sans KR', sans-serif; }
    .icon-btn { display:flex; flex-direction:column; align-items:center; justify-content:center; border-radius:0.75rem; padding:1rem; border:1px solid #e5e7eb; cursor:pointer; }
    .icon-btn:hover { background:#f8fafc; }
    .dropzone { border:2px dashed #cbd5e1; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">

  <!-- ë¹„ë°€ë²ˆí˜¸ ê²Œì´íŠ¸ -->
  <div id="gate" class="fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-red-100 via-white to-blue-100">
    <div class="rounded-2xl shadow-2xl max-w-md w-full mx-4 p-8 border bg-white">
      <h1 class="text-2xl font-bold mb-2">ë””ì§€í„¸ ì†Œë°©ì°¨ëŸ‰ ì•„ì¹´ì´ë¸Œ</h1>
      <p class="text-sm mb-6">ì•„ì´ë”” ì—†ì´ ë¹„ë°€ë²ˆí˜¸ë§Œìœ¼ë¡œ ì ‘ê·¼í•©ë‹ˆë‹¤. (ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸: <span class="font-mono">119rescue</span>)</p>
      <input id="pw" type="password" class="w-full rounded-xl border px-4 py-3" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥" />
      <button id="enterBtn" class="mt-4 w-full rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3">ì…ì¥</button>
      <p id="pwMsg" class="mt-3 text-sm text-red-600 hidden">ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
    </div>
  </div>

  <!-- í—¤ë” -->
  <header class="sticky top-0 z-40 bg-white/80 backdrop-blur border-b">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-3">
      <h2 class="text-lg md:text-2xl font-bold flex items-center gap-2">ğŸš’ ë””ì§€í„¸ ì°¨ëŸ‰ ì•„ì¹´ì´ë¸Œ</h2>
      <div class="ms-auto flex items-center gap-2 w-full md:w-auto">
        <input id="searchInput" type="text" class="w-full md:w-80 rounded-xl border px-4 py-2" placeholder="#í•´ì‹œíƒœê·¸(ë³µìˆ˜ ê°€ëŠ¥) ì˜ˆ: #íŒí”„ #ì ê²€" />
        <button id="searchBtn" class="rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2">ê²€ìƒ‰</button>
      </div>
    </div>
  </header>

  <!-- ë©”ì¸ -->
  <main class="max-w-7xl mx-auto px-4 py-6 space-y-8">

    <!-- ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜ -->
    <section class="grid grid-cols-2 md:grid-cols-5 gap-4">
      <div class="icon-btn" onclick="scrollToCat('ë¬¼íƒ±í¬ì°¨')">ğŸš›<span>ë¬¼íƒ±í¬ì°¨</span></div>
      <div class="icon-btn" onclick="scrollToCat('ì¤‘í˜•íŒí”„ì°¨')">ğŸš’<span>ì¤‘í˜•íŒí”„ì°¨</span></div>
      <div class="icon-btn" onclick="scrollToCat('ì†Œí˜•íŒí”„ì°¨')">ğŸš<span>ì†Œí˜•íŒí”„ì°¨</span></div>
      <div class="icon-btn" onclick="scrollToCat('êµ¬ê¸‰ì°¨')">ğŸš‘<span>êµ¬ê¸‰ì°¨</span></div>
      <div class="icon-btn" onclick="scrollToCat('êµ´ì ˆ ë° ì‚¬ë‹¤ë¦¬ì°¨')">ğŸªœ<span>êµ´ì ˆ/ì‚¬ë‹¤ë¦¬ì°¨</span></div>
    </section>

    <!-- ìë£Œ ë“±ë¡ -->
    <section class="rounded-2xl bg-white border p-4">
      <h3 class="text-xl font-bold mb-3">ìë£Œ ë“±ë¡</h3>
      <div class="grid md:grid-cols-2 gap-4">
        <input id="fTitle" placeholder="ì œëª©" class="rounded-xl border px-3 py-2" />
        <select id="fCategory" class="rounded-xl border px-3 py-2">
          <option>ë¬¼íƒ±í¬ì°¨</option>
          <option>ì¤‘í˜•íŒí”„ì°¨</option>
          <option>ì†Œí˜•íŒí”„ì°¨</option>
          <option>êµ¬ê¸‰ì°¨</option>
          <option>êµ´ì ˆ ë° ì‚¬ë‹¤ë¦¬ì°¨</option>
        </select>
        <textarea id="fText" rows="3" class="md:col-span-2 rounded-xl border px-3 py-2" placeholder="ë‚´ìš©(ì„ íƒ)"></textarea>
        <input id="fTags" placeholder="#íƒœê·¸,ì‰¼í‘œêµ¬ë¶„  ì˜ˆ: #íŒí”„,#ì ê²€" class="md:col-span-2 rounded-xl border px-3 py-2" />
        <div class="md:col-span-2">
          <label class="block text-sm mb-1">ì´ë¯¸ì§€ (ì„ íƒ)</label>
          <div id="dropZone" class="dropzone rounded-xl p-4 text-sm text-gray-500 text-center cursor-pointer bg-white">
            ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒ
          </div>
          <input id="fImage" type="file" accept="image/*" class="hidden" />
          <img id="imgPreview" class="mt-2 max-h-52 rounded-lg hidden" />
        </div>
        <button id="btnAdd" class="md:col-span-2 rounded-xl bg-green-600 text-white py-2">ë“±ë¡</button>
      </div>
    </section>

    <!-- ì•„ì¹´ì´ë¸Œ -->
    <section id="categories" class="space-y-10"></section>
  </main>

  <script>
    // ê²Œì´íŠ¸
    document.getElementById('enterBtn').onclick = function(){
      const val = document.getElementById('pw').value;
      if(val === '119rescue'){ document.getElementById('gate').classList.add('hidden'); }
      else { document.getElementById('pwMsg').classList.remove('hidden'); }
    };

    const CATEGORIES = ['ë¬¼íƒ±í¬ì°¨','ì¤‘í˜•íŒí”„ì°¨','ì†Œí˜•íŒí”„ì°¨','êµ¬ê¸‰ì°¨','êµ´ì ˆ ë° ì‚¬ë‹¤ë¦¬ì°¨'];
    const categoriesRoot = document.getElementById('categories');
    let items = [
      {id:1, title:'íŒí”„ ì ê²€ ì²´í¬ë¦¬ìŠ¤íŠ¸', category:'ì¤‘í˜•íŒí”„ì°¨', text:'íŒí”„ ê°€ë™ ì „ ì˜¤ì¼, ëƒ‰ê°ìˆ˜, ì••ë ¥ í™•ì¸ ì ˆì°¨.', tags:['íŒí”„','ì ê²€']},
      {id:2, title:'êµ¬ê¸‰ì°¨ ì‚°ì†Œí†µ êµì²´', category:'êµ¬ê¸‰ì°¨', text:'ì‚°ì†Œí†µ êµì²´ ë‹¨ê³„ë³„ ì ˆì°¨ ë° ì£¼ì˜ì‚¬í•­.', tags:['ì‚°ì†Œ','êµ¬ê¸‰ì°¨']},
      {id:3, title:'ì‚¬ë‹¤ë¦¬ì°¨ ì•ˆì „ë²¨íŠ¸ ì‚¬ìš©ë²•', category:'êµ´ì ˆ ë° ì‚¬ë‹¤ë¦¬ì°¨', text:'ì‘ì—… ì „ ë°˜ë“œì‹œ ì°©ìš©í•´ì•¼ í•˜ëŠ” ì•ˆì „ë²¨íŠ¸ ì‚¬ìš©ë²•.', tags:['ì•ˆì „','ë²¨íŠ¸']}
    ];

    // ë Œë”ë§
    function renderAll(){
      categoriesRoot.innerHTML = '';
      CATEGORIES.forEach(function(cat){
        const sec = document.createElement('div');
        sec.id = 'cat-'+cat;
        sec.innerHTML = "<h3 class='text-xl font-bold mb-3'>"+cat+"</h3>";
        const list = document.createElement('div');
        list.className = 'grid gap-3';
        items.filter(function(x){ return x.category===cat; }).forEach(function(it){
          const card = document.createElement('div');
          card.className = 'rounded-xl border p-3 bg-white';
          card.id = 'item-'+it.id;
          card.innerHTML = "<h4 class='font-semibold'>"+it.title+"</h4>"
                          + (it.url ? "<img class='mt-2 rounded-md max-h-52' src='"+it.url+"' alt='"+it.title+"'/>" : "")
                          + "<p class='text-sm'>"+(it.text||"")+"</p>"
                          + "<div class='text-xs text-gray-500'>#"+(it.tags||[]).join(' #')+"</div>";
          list.appendChild(card);
        });
        if(list.children.length===0){
          list.innerHTML = '<p class="text-sm text-gray-500">ë“±ë¡ëœ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
        }
        sec.appendChild(list);
        categoriesRoot.appendChild(sec);
      });
    }
    renderAll();

    // ë“±ë¡
    window._droppedImageDataURL = '';
    const dropZone = document.getElementById('dropZone');
    const fImage = document.getElementById('fImage');
    const imgPreview = document.getElementById('imgPreview');

    dropZone.addEventListener('click', function(){ fImage.click(); });
    ['dragenter','dragover'].forEach(function(ev){
      dropZone.addEventListener(ev, function(e){ e.preventDefault(); dropZone.classList.add('bg-gray-50'); });
    });
    ['dragleave','drop'].forEach(function(ev){
      dropZone.addEventListener(ev, function(e){ e.preventDefault(); dropZone.classList.remove('bg-gray-50'); });
    });
    dropZone.addEventListener('drop', function(e){
      const file = e.dataTransfer && e.dataTransfer.files && e.dataTransfer.files[0];
      if(file) handleImage(file);
    });
    fImage.addEventListener('change', function(e){
      const file = e.target.files && e.target.files[0];
      if(file) handleImage(file);
    });

    function handleImage(file){
      if(!file.type.startsWith('image/')){ alert('ì´ë¯¸ì§€ íŒŒì¼ì„ ì˜¬ë ¤ì£¼ì„¸ìš”.'); return; }
      const reader = new FileReader();
      reader.onload = function(){
        window._droppedImageDataURL = reader.result;
        imgPreview.src = reader.result;
        imgPreview.classList.remove('hidden');
      };
      reader.readAsDataURL(file);
    }

    document.getElementById('btnAdd').onclick = function(){
      const title = document.getElementById('fTitle').value.trim();
      const category = document.getElementById('fCategory').value;
      const text = document.getElementById('fText').value.trim();
      const tags = document.getElementById('fTags').value.split(',').map(function(t){ return t.replace('#','').trim();}).filter(Boolean);
      if(!title){ alert('ì œëª© ì…ë ¥'); return; }
      const url = window._droppedImageDataURL || '';
      items.push({id:Date.now(), title, category, text, tags, url});
      renderAll();
      // reset form preview
      window._droppedImageDataURL = '';
      imgPreview.classList.add('hidden'); imgPreview.src='';
      fImage.value='';
      document.getElementById('fTitle').value='';
      document.getElementById('fText').value='';
      document.getElementById('fTags').value='';
    };

    // ì¹´í…Œê³ ë¦¬ ì´ë™
    function scrollToCat(cat){
      const el = document.getElementById('cat-'+cat);
      if(el) el.scrollIntoView({behavior:'smooth'});
    }
    window.scrollToCat = scrollToCat; // expose for onclick

    // í•´ì‹œíƒœê·¸ ê²€ìƒ‰ â†’ í•´ë‹¹ ì¹´ë“œ ìœ„ì¹˜ë¡œ ì´ë™ & í•˜ì´ë¼ì´íŠ¸
    document.getElementById('searchBtn').onclick = function(){
      const raw = document.getElementById('searchInput').value.trim();
      if(!raw){ alert('í•´ì‹œíƒœê·¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”. ì˜ˆ: #íŒí”„'); return; }
      const tokens = raw.replace(/#/g,'').split(/\\s+/).filter(Boolean);
      const item = items.find(function(x){ return tokens.every(function(t){ return (x.tags||[]).includes(t); }); });
      if(item){
        scrollToCat(item.category);
        setTimeout(function(){
          const el = document.getElementById('item-'+item.id);
          if(el){ el.scrollIntoView({behavior:'smooth', block:'center'}); el.classList.add('ring','ring-blue-400'); setTimeout(function(){ el.classList.remove('ring','ring-blue-400'); }, 1500); }
        }, 300);
      } else {
        alert('ì¼ì¹˜í•˜ëŠ” ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤.');
      }
    };
  </script>
</body>
</html>
